events {
    worker_connections 1024;
}

http {
    access_log off;
    error_log /dev/stderr warn;

    upstream backend1 {
        server 45.80.228.158:443;
        keepalive 32;
    }

    upstream backend2 {
        server 45.156.22.157:443;
        keepalive 32;
    }

    upstream backend3 {
        server 91.108.189.192:443;
        keepalive 32;
    }
	
    upstream backend4 {
        server  94.183.232.78:443;
        keepalive 32;
    }

    upstream backend5 {
        server 31.56.206.240:443;
        keepalive 32;
    }
	
    server {
        listen ${PORT};
        server_name _;

        location /panelws1 {
            proxy_pass https://backend;
            proxy_http_version 1.1;
            proxy_ssl_server_name on;

            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";

            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Forwarded-Host $host;

            proxy_connect_timeout 30s;
            proxy_send_timeout 90s;
            proxy_read_timeout 90s;
            proxy_buffering off;
            proxy_request_buffering off;

        }

        location /panelws2 {
            proxy_pass https://backend2;
            proxy_http_version 1.1;
            proxy_ssl_server_name on;

            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";

            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Forwarded-Host $host;

            proxy_connect_timeout 30s;
            proxy_send_timeout 90s;
            proxy_read_timeout 90s;
            proxy_buffering off;
            proxy_request_buffering off;
        }

        location /panelws3 {
            proxy_pass https://backend3;
            proxy_http_version 1.1;
            proxy_ssl_server_name on;

            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";

            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Forwarded-Host $host;

            proxy_connect_timeout 30s;
            proxy_send_timeout 90s;
            proxy_read_timeout 90s;
            proxy_buffering off;
            proxy_request_buffering off;
        }

        location /panelws4 {
            proxy_pass https://backend4;
            proxy_http_version 1.1;
            proxy_ssl_server_name on;

            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";

            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Forwarded-Host $host;

            proxy_connect_timeout 30s;
            proxy_send_timeout 90s;
            proxy_read_timeout 90s;
            proxy_buffering off;
            proxy_request_buffering off;
        }
		
        location /panelws5 {
            proxy_pass https://backend5;
            proxy_http_version 1.1;
            proxy_ssl_server_name on;

            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";

            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Forwarded-Host $host;

            proxy_connect_timeout 30s;
            proxy_send_timeout 90s;
            proxy_read_timeout 90s;
            proxy_buffering off;
            proxy_request_buffering off;
        }
		
        location /health {
            return 200 "OK\n";
            add_header Content-Type text/plain;
        }

        location / {
            return 301 https://ya.ru$request_uri;
        }
    }
}
